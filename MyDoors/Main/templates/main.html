<!DOCTYPE html>
<html lang="en">
<head>
    {% load static %}
    <meta charset="UTF-8">
    <title>Doors</title>
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
</head>
<body>
    <h1>Filter Doors</h1>
    <div class="box" style="display: flex">
        <div>
        <img  class="Door" src="" alt="" height="200px">
    </div>
        <div>
            <form method="get" action="{% url 'main' %}">

                <label >Select Shape:</label>
                <div id = 'select_shape'>
                    <input type="hidden" name = "shape" id ="shape" value="">

                </div>




                <label >Select Portal:</label>
                <div id="select_portal" >
                    <input type="hidden" name = "portal" id ="portal" value="">

                </div>

                <label >Select Bevel:</label>
                <div id="select_bevel" >
                    <input type="hidden" name = "bevel" id ="bevel" value="">

                </div>

                <label >Select Molding:</label>
                <div id="select_molding" >
                    <input type="hidden" name = "molding" id ="molding" value="">

                </div>

                <label >Select Color:</label>
                <div id="select_color" >
                    <input type="hidden" name = "color" id ="color" value="">

                </div>
                <br>
                <button type="submit">Submit</button>
            </form>
        </div>

    </div>



    <script>
        var data = {{ data|safe }};

        data['shapes'].forEach(element => add_element(element,'#select_shape','shape'));
        data['portals'].forEach(element => add_element(element,'#select_portal','portal'));
        data['bevels'].forEach(element => add_element(element,'#select_bevel','bevel'));
        data['moldings'].forEach(element => add_element(element,'#select_molding','molding'));
        data['color'].forEach(element => add_element(element,'#select_color','color'));

        let shape;
        let portal;
        let bevel;
        let molding;
        let color;

        function add_element(object, target , type){
            type ="'"+type+"'";

            $(target).append('<button type="button" class='+type+' id = "type_'+object['id']+'" onclick="set_value(this,'+type+')" ' +
                'value = "' + object['id'] + '">' + object['name'] + '</button>');
        }
        function set_value(object , type){
            switch (type) {
                case 'shape':
                    shape = object.value;
                    show_element('portal')
                    data['portals'].forEach(element =>hide_element(element,'portal','shape',object.innerHTML));
                    break;
                case 'portal':
                    portal = object.value;
                    show_element('bevel')
                    data['bevels'].forEach(element =>hide_element(element,'bevel','portal',object.innerHTML));
                    break;
                case 'bevel':
                    bevel = object.value;
                    show_element('molding')
                    data['moldings'].forEach(element =>hide_element(element,'molding','bevel',object.innerHTML));
                    break;
                case 'molding':
                    molding = object.value;
                    break;
                case 'color':
                    color = object.value;
                    break;
            }
            $('#'+type).attr('value' , object.value);

        }
        function hide_element(array, target,type, attr){

            // $("." + target+"[value='"+array['id']+"']").hide();
            if(array[type] !== attr){
                $("." + target+"[value='"+array['id']+"']").hide();

            }

        }
        function show_element(target){
            $("." + target).show();
        }


    </script>

</body>
</html>
